<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230" /><meta name="keywords" content="4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1998/01/4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230/" property="og:url"><meta content="2018-06-21T22:53:40+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230"><meta name="twitter:url" content="http://localhost:4000/archive/1998/01/4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1998-01-07---fiats-batch-rsa">1998-01-07 - Fiat’s Batch RSA</h1><h2 id="header-data">Header Data</h2><p>From: Anonymous &lt;nobody@REPLAY.COM&gt;<br /> To: cypherpunks@cyberpass.net<br /> Message Hash: 4658e329f7bba6a730ce20e71616a373cc9dc2491255f1b3b036ce263525e230<br /> Message ID: &lt;199801071855.TAA07264@basement.replay.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1998-01-07 19:11:02 UTC<br /> Raw Date: Thu, 8 Jan 1998 03:11:02 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Anonymous &lt;nobody@REPLAY.COM&gt;
Date: Thu, 8 Jan 1998 03:11:02 +0800
To: cypherpunks@cyberpass.net
Subject: Fiat's Batch RSA
Message-ID: &lt;199801071855.TAA07264@basement.replay.com&gt;
MIME-Version: 1.0
Content-Type: text/plain



Batch RSA
invented by Amos Fiat

Described in Crypto 89 and J Cryptology 1997.


RSA works as follows.  The key owner chooses two secret primes p and q,
and forms their product n = p*q.  He then chooses a public exponent e
relatively prime to p-1 and q-1.  His public key is (n, e).

To encrypt a message m into cyphertext c, m is raised to the power e, mod
n: c = m^e mod n.  To decrypt the message, the key holder calculates d
as the multiplicative inverse of e mod (p-1)(q-1): d = 1/e mod (p-1)(q-1).
He recovers m from m = c^d mod n.

For simplicity, below we will write this as m = c^(1/e) mod n, where it
is understood that the 1/e is done mod (p-1)(q-1).

An RSA signature s on a message m is calculated as for a decryption:
s = m^(1/e) mod n.  The signature is verified by m ?=? s^e mod n.

The time consuming part of an RSA decryption or signature is this
exponentiation step.  e can be chosen to be small, so encryption and
verification is fast, but 1/e will generally be about the same size as n,
so many multiplications must be done to raise a number to that power.

Amos Fiat describes a method whereby multiple messages can be decrypted
or signed using only one full-sized exponentiation.  The "catch" is that
the messages must all use different exponents with the same n.

Here is a concrete example.  You want to decrypt or sign two messages,
M1 and M2, raising M1 to the 1/3 power and M2 to the 1/5 power.  Perform
the following steps:

	M12 = M1^5  *  M2^3
	I12 = M12 ^ (1/15)

This is the only full-sized exponentiation needed.  This gives:

	I12 = M1^(1/3) * M2^(1/5).

This is the product of the two values that we want.  Fiat uses a trick
to disentangle the two values.  He raises I12 to the 6th power.  The
number 6 is chosen so that it is a multiple of one of the two
exponents, 3, and is 1 more than a multiple of the other exponent, 5:

	I12^6 = M1^2 * M2 * M2^(1/5)

Therefore:

	M2^(1/5) = I12^6 / (M1^2 * M2)

which is one of the values we need.  Since I12 is the product of the two
values we want, we can recover the other value just by dividing this into
I12:

	M1^(1/3) = I12 / M2^(1/5)


Here is another example.  Suppose we want M3^(1/7) and M4^(1/11).  (Note
that we are using prime numbers for the exponents; the reason will be
explained below.)  We calculate:

	M34 = M3^11  *  M4^7
	I34 = M34 ^ (1/77)

This gives us:

	I34 = M3^(1/7) * M4^(1/11)

Again this is the product of the two values we want.  As before we will
raise this to a power which is 1 more than a multiple of one of the two
exponents (7 and 11) and is a multiple of the other one.  The smallest
such power is 22.

	I34^22 = M3^3 * M3^(1/7) * M4^2

So we can divide to get M3^(1/7):

	M3^(1/7) = I34^22 / (M3^3 * M4^2)

And we can divide to get the other value needed:

	M4^(1/11) = I34 / M3^(1/7)


This illustrates how to derive two RSA roots using only one full sized
exponentiation.  A few small exponentiations are also needed, as well
as two divisions, but these are much faster than doing the full
exponentiation (raising to the 1/15 or 1/77 powers above).

Fiat's idea can then be applied recursively.  Note that in the examples
above we had to take two full-sized exponentiation, M12 to the 1/15 power
and M34 to the 1/77 power.  We can combine both of these exponentiations
into one just as was done above:

	M14 = M12^77 * M34^15
	I14 = M14 ^ (1/1155)

Now:

	I14 = M12^(1/15) * M34^(1/77)

the product of the two values we want.  We need an exponent which is
1 more than a multiple of 15 while being a multiple of 77, giving
615, or vice versa, giving 540.  Choosing the latter since it is smaller
we have:

	I14^540 = M12^36 * M34^7 * M34^(1/77)

so:

	M34^(1/77) = I14^540 / (M12^36 * M34^7)

and dividing gives the other factor:

	M12^(1/15) = I14 / M34^(1/77)

These values can then be fed into the expressions above to recover
M1^(1/3) and the other three values, all with only one full-sized
exponentiation for the four messages.

In general, finding the exponent for Ixx can be handled by the Chinese
Remainder Theorem.  However it requires that the two values be
relatively prime.  That is why the exponents used in Batch RSA must
all be relatively prime, so that there is a solution to the value of
the exponent for Ixx.

As the number of values in the batch increases, the "small" exponents
needed to recover the values increase as well.  We saw above that the
exponents went from 6 and 22 for the size-two batches to 540 for the
size-four batch.  This means that you reach a point of diminishing
returns where increasing the batch size no longer provides much
benefit.  Fiat suggests a batch size of n/(log^2 n) messages, where n
is the length of the full-sized exponentiation (e.g. 1000 for a 1000
bit modulus).  This would correspond to about a 10 message batch for
a 1024 bit key.

Fiat describes a few situations where it may be appropriate to use
different exponents for multiple RSA operations.  In the case of a
server issuing multiple RSA signatures it could define its public key
to be (n, e1, e2, e3,...) and specify that the signature was valid for
any exponent in the list.  Then it could batch up signatures and use a
different exponent for each one.

Another case is "pure RSA" encryption, where the message itself is broken
into blocks and each one is RSA encrypted.  In that case the blocks could
use successive exponents from the list, and the receiver could decrypt
a batch of blocks using one large exponentiation.

There is another case of interest to us, related to the task of
searching through messages from a message pool, possibly
steganographically hidden.  That will be described in another message.






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1998/01">January 1998</a><li><p>1998-01-07 (Thu, 8 Jan 1998 03:11:02 +0800) - Fiat’s Batch RSA - <em>Anonymous &lt;nobody@REPLAY.COM&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
