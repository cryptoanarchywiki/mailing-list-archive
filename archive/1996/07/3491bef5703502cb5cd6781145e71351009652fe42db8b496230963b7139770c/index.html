<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c" /><meta name="keywords" content="3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/07/3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c/" property="og:url"><meta content="2018-06-23T00:09:03+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c"><meta name="twitter:url" content="http://localhost:4000/archive/1996/07/3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-07-18---educational-cryptanalysis-competition-small-prize">1996-07-18 - Educational cryptanalysis competition (small prize)</h1><h2 id="header-data">Header Data</h2><p>From: peter.allan@aeat.co.uk (Peter M Allan)<br /> To: cypherpunks@toad.com<br /> Message Hash: 3491bef5703502cb5cd6781145e71351009652fe42db8b496230963b7139770c<br /> Message ID: &lt;9607171243.AA26209@clare.risley.aeat.co.uk&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1996-07-18 08:23:10 UTC<br /> Raw Date: Thu, 18 Jul 1996 16:23:10 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: peter.allan@aeat.co.uk (Peter M Allan)
Date: Thu, 18 Jul 1996 16:23:10 +0800
To: cypherpunks@toad.com
Subject: Educational cryptanalysis competition (small prize)
Message-ID: &lt;9607171243.AA26209@clare.risley.aeat.co.uk&gt;
MIME-Version: 1.0
Content-Type: text/plain


-----BEGIN PGP SIGNED MESSAGE-----



Educational Cryptanalysis Competition  (opened 17 July 1996)
=====================================

Cypherpunks teach.  Here's your chance.

I have a piece of code I wrote ages ago, before reading Schneier.

Despite identifying these points as weaknesses I still cannot
break it.

    weak keys
    rapid collapse in the case of chosen text attack
    reduced-round versions have a correlation attack

Obviously my crytanalysis needs some serious help.



The aim of this competition is:
    to show how to find AND EXPLOIT weaknesses in this cypher.
    Answers resembling "That's junk - use XXXXX." score zero.
    Well-prepared comprehensive answers could score highly.

- - Entries will be judged on educational grounds as well as on raw results.

- - All entries are placed by the entrant in the public domain, and there
  may be a compilation of good answers come out of this.
  (With entrants' names except where they state a prefernce for anonymity. )

- - Entries by teams are allowed.

- - The number of entries is unlimited.

- - The closing date is 30 Sept 1996.

- - The judge is Peter Allan. (me)

- - There is one prize (a box of chocolate coffee beans).


  
A full pair of programs using this code can be collected
from my mail filter.

    echo  rlprm_2.0 | mail -s send_goodies peter.allan@aeat.co.uk



Peter Allan   peter.allan@aeat.co.uk

#define RPT        15
#define CRYPT_DEPTH 4  
/**********************************/
mkkey(origpass, key)
/***
****  The pass (a text string) is used to produce
****  a key.  Chars used as int. Details in docs.
****  200000 passwords all gave different keys in my test.
***/
char origpass[9];
unsigned char key[8];
{

	char clearpass[9];
	int  i, j, k, l, m, ten;

 /***  make the key from the clearpass ***/
 /***  unsigned char[8] from char[9] ***/

	ten = FALSE;
	k = l = m = 0;
	strcpy(clearpass, origpass);


	for (i = 0; i &lt; 8; i++) {
		if (clearpass[i] == '\n')
			ten = TRUE;
		if (ten)
			clearpass[i] = '\0';
	}
	clearpass[8] = '\0';


	for (i = 0; i &lt; 8; i++)
		key[i] = (unsigned char) i;
	for (j = 1; j &lt; 256; j++) {
		for (i = 0; i &lt; 8; i++)
			key[i] = key[i] + clearpass[i] + j;
	/* swap bytes */
		k = key[j % 8] % 8;
		l = key[k] % 8;

		m = key[k];
		key[k] = key[l];
		key[l] = m;

/** this loop is redundant if chars are 8 bits
***  and for all I know they are everywhere **/

		for (i = 0; i &lt; 8; i++)
			key[i] = key[i] % 256;

		m = m % 8;
		key[m] = 256 - key[m];
	}


/****
	for (i = 0; i &lt; 8; i++)
		printf("%d ", key[i]);
	puts(" ");
****/

}


/**********************************/
sym_encrypt(abpos, key, authbuf, cipherbuf)
int  abpos;
unsigned char key[8];
unsigned char authbuf[ABLEN];
unsigned char cipherbuf[MESSLEN];
{
	int  i, j, k, ptr1, ptr2, rpt;
	int  ka1, ka2, kk;
	unsigned char smoke[CRYPT_DEPTH][8];
	unsigned char tmp;


/***
****  From the key, make a set of keys to
****  be used in order.
***/

	for (j = 0; j &lt; 8; j++)
		smoke[0][j] = key[j];

	for (i = 1; i &lt; CRYPT_DEPTH; i++) {
		for (j = 0; j &lt; 8; j++)
			smoke[i][j] = smoke[i - 1][j];

		for (j = 0; j &lt; 8; j++) {
			if (j % 2) {
				smoke[i][j] = (smoke[i][j]) * 3;
			}
			else {
				smoke[i][j] = ((smoke[i][j]) * 3) / 4;
			}
		}
	}



#ifndef NOCRYPT
/***
****     see the tech waffle file for details
***/

	for (rpt = RPT; rpt; rpt--) {
		if (cl_debug)
			printf("encryption repeat count is %d \n", rpt);
		for (i = 0; i &lt; CRYPT_DEPTH; i++) {
/**swap driven by values **/

			for (k = 0; k &lt; abpos - 1; k += 2) {
				kk = authbuf[k] ^ authbuf[k + 1];
				ka1 = kk / 16;
				ka2 = kk % 16;
				kk = ka1 ^ ka2;
				if ((kk == 1) || (kk == 2) || (kk == 4) || (kk == 8) ||
				    (kk == 14) || (kk == 13) || (kk == 11) || (kk == 7)) {
					kk = authbuf[k];
					authbuf[k] = authbuf[k + 1];
					authbuf[k + 1] = kk;
				}

			}

/** xor with key **/
			for (k = 0; k &lt; abpos; k++)
				authbuf[k] ^= (key[k % 8]);

/**rotation **/
			kk = authbuf[abpos - 1] / 32;
			ka1 = 0;
			for (k = 0; k &lt; abpos; k++) {
				ka2 = authbuf[k] / 32;
				authbuf[k] = (authbuf[k] * 8) + ka1;
				ka1 = ka2;
			}
			authbuf[0] += kk;
/**swap driven by key **/

			if (cl_debug)
				printf("   depth is %d \n", i);
			for (j = 0; j &lt; 8; j = j + 2) {
				ptr1 = smoke[i][j] % abpos;
				ptr2 = smoke[i][j + 1] % abpos;

				tmp = authbuf[ptr1];
				authbuf[ptr1] = authbuf[ptr2];
				authbuf[ptr2] = tmp;
			}
		}
	}
#endif



 /***   Now that it has been encrypted it should
 ****   be stored as 'hexabetical'  [A-P].
 ***/
	for (i = 0; i &lt; abpos; i++) {
		cipherbuf[i * 2] = (authbuf[i] % 16) + 'A';
		cipherbuf[i * 2 + 1] = (authbuf[i] / 16) + 'A';
	}
	cipherbuf[abpos * 2] = '\0';
}

/********************************/

sym_decrypt(abpos, key, authbuf, cipherbuf)
int  abpos;
unsigned char key[8];
unsigned char authbuf[ABLEN];
unsigned char cipherbuf[MESSLEN];
{
	int  i, j, k, ptr1, ptr2, rpt;
	int  ka1, ka2, kk;
	unsigned char smoke[CRYPT_DEPTH][8];
	unsigned char tmp;


	for (i = 0; cipherbuf[i]; i = i + 2) {
		cipherbuf[i] = cipherbuf[i] - 'A';
		cipherbuf[i + 1] = cipherbuf[i + 1] - 'A';
		authbuf[i / 2] = cipherbuf[i] +
			cipherbuf[i + 1] * 16;
	}

/***
****  From the key, make a set of keys to
****  be used in order.
***/

	for (j = 0; j &lt; 8; j++)
		smoke[0][j] = key[j];

	for (i = 1; i &lt; CRYPT_DEPTH; i++) {
		for (j = 0; j &lt; 8; j++)
			smoke[i][j] = smoke[i - 1][j];

		for (j = 0; j &lt; 8; j++) {
			if (j % 2) {
				smoke[i][j] = smoke[i][j] * 3;
			}
			else {
				smoke[i][j] = (smoke[i][j] * 3) / 4;
			}
		}

	}

#ifndef NOCRYPT
/***
****  repeat suitable number of times:
****     first swap bytes in the authbuf
****     then cycle bits round to prevent some swaps undoing others
***/
	if (abpos == 0)
		return RUBBISH;	/** zerodivide detected-avoided **/

	for (rpt = RPT; rpt; rpt--) {
	/* printf("encryption repeat count is %d \n", rpt); */
		for (i = CRYPT_DEPTH - 1; i &gt; -1; i--) {
			for (j = 6; j &gt; -1; j = j - 2) {
/*** key-driven swap  ***/
				ptr1 = smoke[i][j] % abpos;
				ptr2 = smoke[i][j + 1] % abpos;

				tmp = authbuf[ptr1];

				authbuf[ptr1] = authbuf[ptr2];
				authbuf[ptr2] = tmp;
			}
/**rotation **/
			kk = authbuf[0] % 8;
			ka1 = 0;
			for (k = abpos - 1; k &gt;= 0; k--) {
				ka2 = authbuf[k] % 8;
				authbuf[k] = (authbuf[k] / 8) + ka1;
				ka1 = ka2 * 32;
			}
			authbuf[abpos - 1] += (kk * 32);


/** xor with key **/
			for (k = 0; k &lt; abpos; k++)
				authbuf[k] ^= (key[k % 8]);


/*** value-driven swap  ***/

			for (k = 0; k &lt; abpos - 1; k += 2) {
				kk = authbuf[k] ^ authbuf[k + 1];
				ka1 = kk / 16;
				ka2 = kk % 16;
				kk = ka1 ^ ka2;
				if ((kk == 1) || (kk == 2) || (kk == 4) || (kk == 8) ||
				    (kk == 14) || (kk == 13) || (kk == 11) || (kk == 7)) {
					kk = authbuf[k];
					authbuf[k] = authbuf[k + 1];
					authbuf[k + 1] = kk;
				}

			}

		}
	}
#endif

}

/**********************/

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv

iQCVAgUBMezfIB98EdWB2LS9AQFbwgP+Oq8zBlI5d1comIQ5S2+ysnSDLAN5W/L2
UgQyrYZ/Cchn9I8CEFn9UDevmInpABSL8yNQWUHrb4cvWxiTGNnFz54gicaPT7Ki
qVETDC5o7nxWOT8qhWmGNTApJC8RBjEkY+90HyYKf2sLEd8hkGLwOGSAF/YWxqkY
TKqYWVNKCjA=
=3qEU
-----END PGP SIGNATURE-----





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1996/07">July 1996</a><li><p>1996-07-18 (Thu, 18 Jul 1996 16:23:10 +0800) - Educational cryptanalysis competition (small prize) - <em>peter.allan@aeat.co.uk (Peter M Allan)</em><ul><li>1996-07-19 (Fri, 19 Jul 1996 13:59:17 +0800) - <a href="/archive/1996/07/29042b33b47154d836fa1be353041c874c5c236f650c8c6c40946376c5aa61a2">Re: Educational cryptanalysis competition (small prize)</a> - <em>daw@cs.berkeley.edu (David Wagner)</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
