<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title>
    <meta name="author" content="cryptoanarchy.wiki" />
    <meta name="description" content="5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad" />
    <meta name="keywords" content="5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name">

    

    
      <meta content="5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description">
    

    
      <meta content="http://localhost:4000/archive/1993/07/5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad/" property="og:url">
    

    
      <meta content="2018-06-20T21:43:48+02:00" property="article:published_time">
      <meta content="http://localhost:4000/about/" property="article:author">
    

    
      <meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image">
    

    
      
    

    
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@_cryptoanarchy">
    <meta name="twitter:creator" content="@_cryptoanarchy">

    
      <meta name="twitter:title" content="5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad">
    

    
      <meta name="twitter:url" content="http://localhost:4000/archive/1993/07/5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad/">
    

    
      <meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1>
          
            <div class="profile-about">
              Arise, you have nothing to lose but your barbed wire fences!
            </div>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a></li>
              
                <li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a></li>
            <li><a href="/">Archive Home</a></li>
          </ul>
          <hr>
          <ul class="sidebar-nav">
            <strong>Similar Resources</strong>
            
              <li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a></li>
            
              <li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a></li>
            
              <li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <h1 id="1993-07-08---some-source-code-for-phone-number-coding">1993-07-08 - Some source code for phone number coding…</h1>

<h2 id="header-data">Header Data</h2>

<p>From: Nickey MacDonald &lt;i6t4@jupiter.sun.csd.unb.ca&gt;<br />
To: cypherpunks list &lt;cypherpunks@toad.com&gt;<br />
Message Hash: 5adbb86e0f454f59d8289905fc464b48e978737c594bc5167b48af5a32b435ad<br />
Message ID: &lt;Pine.3.05.9307071932.B12475-d100000@jupiter&gt;<br />
Reply To: <em>N/A</em><br />
UTC Datetime: 1993-07-08 05:04:10 UTC<br />
Raw Date: Wed, 7 Jul 93 22:04:10 PDT<br /></p>

<h2 id="raw-message">Raw message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Nickey MacDonald &lt;i6t4@jupiter.sun.csd.unb.ca&gt;
Date: Wed, 7 Jul 93 22:04:10 PDT
To: cypherpunks list &lt;cypherpunks@toad.com&gt;
Subject: Some source code for phone number coding...
Message-ID: &lt;Pine.3.05.9307071932.B12475-d100000@jupiter&gt;
MIME-Version: 1.0
Content-Type: text/plain


Here is a couple of message about my phone encoding format (giving
progressively more info to a person trying to guess the format) followed
by the complete source...  Use it well.  (TABsize was 3.)



Okay, well without giving you the source...  heres the biggest hint I can
think of...

&gt;From /etc/magic:
0	string		\037\235	compressed data

Translating that to decimal and in 4 byte unsigned long we get
  (\037\235\0\0 == 31,157,0,0 == 0,530,382,848
                                 ^^^^^

&gt;From the start of my posted list of phone numbers:
(503) 241-9796  ext: 09
 ^^^                 ^
 ??   ?

If you know the rules for forming (valid looking) phone numbers...

Anyway, to finially give the whole thing away...

The file that is hidden starts with these 4 bytes...

1f 9d 90 54 == 0,530,419,796

Well.. I like puzzles... (as long as the answer is eventually revealed) so
I'll let you think it over for a bit, before I send you the source... ;-)




Okay well... lets assume that all valid phone numbers must be in the form
   [2-9][0-1][0-9]  [2-9][0-9][0-9]  [0-9][0-9][0-9][0-9]

This is the form of my encoding... now if you take a sample number, like
  1,234,567,890
and try encode it into a phone number, you would get
  (123) 456-7890
   ^^
And you notice that the 1 and the two are out of range...
Well.. as it happens, for 32 bit unsigned numbers the range is 0 to
4,294,967,294...  The first digit will always be 0-4, half of which are
illegal in that position, so I decided to swap the first two digits...

That doesn't fix all of the range problems, thus whenever there is an
invalid digit in position 1,2 or 4 I move it to the extension and put a
special indicator value (the higest of the legal range) in its place.

Thats the whole secret...  Code will follow soon...  :-)




/*
	pe.c

	phone encode

	Written by:
		Nickey MacDonald
		July 7, 1993

	Encode a message as a list of phone numbers...  There are some tricks
	used to make the phone numbers appear more realistic, and there is a
	caveate...  If the input file has 4 null bytes aligned of a 4 byte
	boundry, then the program will think its the EOF and stop...  This
	could be fixed easily... I just didn't.
*/


#include &lt;stdio.h&gt;


unsigned long getbytes(FILE *fp);


int main(void)
{
	unsigned short i, ei;					/* i=work counter, ei=ext. counter */
	unsigned char pn[10], ext[4], v=0;	/* Digits of phone num, ext and a */
													/* pseudo random value */
	unsigned long b;							/* 4 bytes compress to a unsigned long */
	char tpnumbuf[11];						/* a sprinft buffer for b */

	/* Read until EOF or 4 properly aligned null bytes */
	while((b=getbytes(stdin)) != 0)
	{
		ei=0;

		/* Convert the unsigned long into a string */
		sprintf(tpnumbuf, "%010lu", b);

		/* Pick up the digits of the unsigned long */

		/* Because of the distribution, swap the first two digits... */
		pn[0]=tpnumbuf[1]-'0';
		pn[1]=tpnumbuf[0]-'0';
		for(i=2; i&lt;10; i++)
		{
			pn[i]=tpnumbuf[i]-'0';
			v+=pn[i];
		}

		/* The first digit of the area code must be [2-9] */
		if (pn[0]&lt;3)
		{
			ext[ei++]=pn[0];
			pn[0]=2;
		}

		/* Currently the middle digit of area code must be 0 or 1 */
		if (pn[1]&gt;0)
		{
			ext[ei++]=pn[1];
			pn[1]=1;
		}

		/* The first digit of prefix must be [2-9] */
		if (pn[3]&lt;3)
		{
			ext[ei++]=pn[3];
			pn[3]=2;
		}

		/* Generate the output phone number */
		fprintf(stdout, "(%d%d%d) %d%d%d-%d%d%d%d", pn[0], pn[1], pn[2],
                                                  pn[3], pn[4], pn[5],
                                                  pn[6], pn[7], pn[8], pn[9]);

		/* Generate the extension if needed */
		if (ei&gt;0)
		{
			ext[ei++]=v%10;
			fprintf(stdout, "  ext: ");
			for (i=0; i&lt;ei; i++)
				fprintf(stdout, "%d", ext[i]);
		}

		fprintf(stdout, "\n");
	}

	return(0);
}


/* Input 4 bytes, convert EOF to null and encode as an unsigned long */
unsigned long getbytes(FILE *fp)
{
	int b[4];
	unsigned short i;

	for(i=0; i&lt;4; i++)
	{
		b[i]=fgetc(fp);
		if (b[i]==EOF)  b[i]=0;
	}

	return(((unsigned long)b[0])&lt;&lt;24 |
          ((unsigned long)b[1])&lt;&lt;16 |
          ((unsigned long)b[2])&lt;&lt; 8 |
          ((unsigned long)b[3]));
}




/*
	pd.c

	phone decode

	Written by:
		Nickey MacDonald
		July 7, 1993

	Decodes a message hidden in a list of phone numbers.
*/


#include &lt;stdio.h&gt;


void putbytes(FILE *fp, unsigned long val);


int main(void)
{
	unsigned short i, ei;	/* i=work counter, ei=extention work counter */
	unsigned char pn[10];	/* The digits of the phone number */
	unsigned long b;			/* The finally decoded value from the phone num */
	char pnline[30];			/* Input line buffer */
	int flg=0;					/* The error message is only output once */

	/* Read lines until end of file */
	while((fgets(pnline, 30, stdin)) != NULL)
	{
		/* error checking */
		if ((pnline[0] != '(')  ||
          (pnline[4] != ')')  ||
          (pnline[9] != '-'))
		{
			if (flg==0)
			{
				fprintf(stderr, "Input not in correct format, output will be garbage!\n");
				flg=1;
			}
		}

		/* Extract the digits of the phone number, and convert from ASCII */
		pn[0]=pnline[1]-'0';
		pn[1]=pnline[2]-'0';
		pn[2]=pnline[3]-'0';

		pn[3]=pnline[6]-'0';
		pn[4]=pnline[7]-'0';
		pn[5]=pnline[8]-'0';

		pn[6]=pnline[10]-'0';
		pn[7]=pnline[11]-'0';
		pn[8]=pnline[12]-'0';
		pn[9]=pnline[13]-'0';

		/* The first digit of the extension should be the 21st loc of input buf */
		ei=21;

		/* The first digit of an area code is always [2-9] */
		if (pn[0]==2)
		{
			pn[0]=pnline[ei++]-'0';
		}

		/* Currently, the middle digit of area code is always 0 or 1 */
		if (pn[1]==1)
		{
			pn[1]=pnline[ei++]-'0';
		}

		/* The first digit of a prefix is always [2-9] */
		if (pn[3]==2)
		{
			pn[3]=pnline[ei++]-'0';
		}

		/* Swap first two digits */
		i=pn[0];
		pn[0]=pn[1];
		pn[1]=i;

		/* Encode the individualt digits into a unsigned long */
		b=0;
		for(i=0; i&lt;10; i++)
			b=b*10+pn[i];

		/* output the decoded bytes */
		putbytes(stdout, b);
	}

	return(0);
}


/* Simple encoding... 4 bytes to the longword...  seperate them here */
void putbytes(FILE *fp, unsigned long val)
{
	int b[4];

	b[0]=(int)(val&gt;&gt;24 &amp; 255);
	b[1]=(int)(val&gt;&gt;16 &amp; 255);
	b[2]=(int)(val&gt;&gt; 8 &amp; 255);
	b[3]=(int)(val     &amp; 255);

	fprintf(fp, "%c%c%c%c", b[0], b[1], b[2], b[3]);
}

--
Nick MacDonald               | NMD on IRC
i6t4@jupiter.sun.csd.unb.ca  | PGP 2.1 Public key available via finger
i6t4@unb.ca                  | (506) 457-1931    ^{1024/746EBB 1993/02/23}







</code></pre></div></div>

<h2 id="thread">Thread</h2>

<ul>
  <li>
    <p>Return to <a href="/archive/1993/07">July 1993</a></p>
  </li>
  <li>
    <p>1993-07-08 (Wed, 7 Jul 93 22:04:10 PDT) - Some source code for phone number coding… - <em>Nickey MacDonald &lt;i6t4@jupiter.sun.csd.unb.ca&gt;</em></p>
  </li>
</ul>


        <footer>
          
            - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a>
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

